!function(r,n,e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define&&define.amd?define("jsonsquasher",e):r.jsonsquasher=e()}(this,0,function(){var r=function(r,n){n=n||{},n.mutateJSON||(r=JSON.parse(JSON.stringify(r)));var t=function(r){if(e(r)){r.unshift([]),r.unshift(1);for(var n=1;n<r.length;n++){var f=r[n],u=[];for(var o in f){var a,s=f[o],v=r[1].indexOf(o);-1!==v?a=v:(a=r[1].length,r[1].push(o)),null!==s&&(u[a]=s),t(s)}r[n]=u}}else if("object"==typeof r){for(var c in r){var f=r[c];t(f)}i(r)&&r.unshift(0)}};return t(r),r},n=function(r,n){n=n||{},n.mutateJSON||(r=JSON.parse(JSON.stringify(r)));var e=function(r){if(i(r)){for(var n=2;n<r.length;n++){var f=r[n];if(t(r)){var u={};for(var o in f){var a=f[o];if(null!==a){var s=r[1][o];u[s]=a}}r[n]=u}e(r[n])}t(r)&&r.shift(),r.shift()}else if("object"==typeof r)for(var s in r){var f=r[s];e(f)}};return e(r),r},e=function(r){if(!i(r))return!1;for(var n=0;n<r.length;n++){var e=r[n];if(!f(e))return!1}return!0},t=function(r){return 1===r[0]},f=function(r){return"object"==typeof r&&!i(r)},i=function(r){return Array.isArray(r)};return{compress:function(n,e){return r(n,e)},decompress:function(r,e){return n(r,e)}}});